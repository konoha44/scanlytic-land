---
layout: null
sitemap: false
---
<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"
        xmlns:xhtml="http://www.w3.org/1999/xhtml">
  {% for page in site.pages %}
    {% unless page.layout == nil or page.sitemap == false %}
      <url>
        <loc>{{ site.url }}{{ page.url | remove: 'index.html' }}</loc>
        {% if page.lang %}
          {% comment %} Получаем базовый путь без языкового префикса {% endcomment %}
          {% assign base_path = page.url | remove_first: '/en' | remove_first: '/ru' | remove_first: '/de' | remove_first: '/fr' | remove_first: '/es' | remove: 'index.html' %}
          {% if base_path == '' %}{% assign base_path = '/' %}{% endif %}
          
          {% comment %} Добавляем альтернативные ссылки для всех языков {% endcomment %}
          {% for lang in site.languages %}
            {% if lang == 'en' %}
              {% if base_path == '/' %}
                <xhtml:link rel="alternate" hreflang="en" href="{{ site.url }}/"/>
              {% else %}
                <xhtml:link rel="alternate" hreflang="en" href="{{ site.url }}/en{{ base_path }}"/>
              {% endif %}
            {% else %}
              <xhtml:link rel="alternate" hreflang="{{ lang }}" href="{{ site.url }}/{{ lang }}{{ base_path }}"/>
            {% endif %}
          {% endfor %}
          
          {% comment %} x-default указывает на английскую версию (default_lang) {% endcomment %}
          {% if base_path == '/' %}
            <xhtml:link rel="alternate" hreflang="x-default" href="{{ site.url }}/"/>
          {% else %}
            <xhtml:link rel="alternate" hreflang="x-default" href="{{ site.url }}/en{{ base_path }}"/>
          {% endif %}
        {% endif %}
        <lastmod>{{ site.time | date_to_xmlschema }}</lastmod>
        <changefreq>{% if page.url == '/' %}daily{% elsif page.url contains '/blog/' %}weekly{% else %}monthly{% endif %}</changefreq>
        <priority>{% if page.url == '/' %}1.0{% elsif page.url contains '/blog/' %}0.7{% else %}0.8{% endif %}</priority>
      </url>
    {% endunless %}
  {% endfor %}
  {% comment %} Process localized posts only (skip original posts with categories in URL) {% endcomment %}
  {% for post in site.posts %}
    {% if post.lang and post.alternate_urls %}
      <url>
        <loc>{{ site.url }}{{ post.url }}</loc>
        {% comment %} Add alternate links for all languages {% endcomment %}
        {% for lang_data in post.alternate_urls %}
          {% assign lang = lang_data[0] %}
          {% assign url = lang_data[1] %}
          <xhtml:link rel="alternate" hreflang="{{ lang }}" href="{{ site.url }}{{ url }}"/>
        {% endfor %}
        {% comment %} Add x-default pointing to English version {% endcomment %}
        {% if post.alternate_urls.en %}
          <xhtml:link rel="alternate" hreflang="x-default" href="{{ site.url }}{{ post.alternate_urls.en }}"/>
        {% endif %}
        <lastmod>{{ post.date | date_to_xmlschema }}</lastmod>
        <changefreq>monthly</changefreq>
        <priority>0.6</priority>
      </url>
    {% endif %}
  {% endfor %}
</urlset>